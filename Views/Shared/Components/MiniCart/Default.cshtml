@model ASM1_NET.Models.Cart

@{
    var totalAmount = Model.CartItems.Sum(i => i.Price * i.Quantity);
    var totalItems = Model.CartItems.Sum(i => i.Quantity);
}

<div class="mini-cart-wrapper">
    <!-- Header -->
    <div class="mini-cart-header">
        <span class="mini-cart-title">üõí Gi·ªè h√†ng</span>
        <span class="mini-cart-count">@totalItems m√≥n</span>
    </div>
    
    <!-- Body -->
    <div class="mini-cart-body">
        @if (Model.CartItems.Any())
        {
            @foreach (var item in Model.CartItems.Take(5))
            {
                var itemName = item.Food?.Name ?? item.Combo?.Name ?? "S·∫£n ph·∫©m";
                var itemImage = item.Food?.ImageUrl ?? item.Combo?.ImageUrl ?? "";
                var isCombo = item.ComboId.HasValue;
                var subtotal = item.Price * item.Quantity;
                
                <div class="mini-cart-item">
                    <div class="mini-cart-item-image">
                        @if (!string.IsNullOrEmpty(itemImage))
                        {
                            <img src="@itemImage" alt="@itemName" onerror="this.parentElement.innerHTML='üçî'" />
                        }
                        else
                        {
                            <span>@(isCombo ? "üéÅ" : "üçî")</span>
                        }
                    </div>
                    
                    <div class="mini-cart-item-info">
                        <span class="mini-cart-item-badge @(isCombo ? "combo" : "food")">
                            @(isCombo ? "COMBO" : "M√ìN ƒÇN")
                        </span>
                        <span class="mini-cart-item-name">@itemName</span>
                        <span class="mini-cart-item-qty">√ó@item.Quantity</span>
                    </div>
                    
                    <span class="mini-cart-item-price">@subtotal.ToString("N0")‚Ç´</span>
                </div>
            }
            
            @if (Model.CartItems.Count > 5)
            {
                <div class="mini-cart-more">
                    +@(Model.CartItems.Count - 5) m√≥n kh√°c...
                </div>
            }
        }
        else
        {
            <div class="mini-cart-empty">
                <div class="mini-cart-empty-icon">üõí</div>
                <p class="mini-cart-empty-text">Gi·ªè h√†ng tr·ªëng</p>
            </div>
        }
    </div>
    
    <!-- Footer -->
    @if (Model.CartItems.Any())
    {
        <div class="mini-cart-footer">
            <div class="mini-cart-total">
                <span class="mini-cart-total-label">T·ªïng c·ªông:</span>
                <span class="mini-cart-total-value">@totalAmount.ToString("N0")‚Ç´</span>
            </div>
            <div class="mini-cart-actions">
                <a href="/Cart" class="mini-cart-btn mini-cart-btn-view">üìã Xem gi·ªè</a>
                <a href="/Order/Checkout" class="mini-cart-btn mini-cart-btn-checkout">üí≥ Thanh to√°n</a>
            </div>
        </div>
    }
</div>