@model IEnumerable<ASM1_NET.Models.Combo>
@{
    ViewData["Title"] = "Combo";
    var keyword = ViewBag.Keyword as string ?? "";
}

<link rel="stylesheet" href="~/client/css/menu.css" />
<link rel="stylesheet" href="~/client/css/modal.css" />

<div class="combo-page menu-page">
    <div class="container">
        <!-- HERO BANNER -->
        <div class="combo-hero menu-hero animate-fade-in">
            <div class="menu-hero-content">
                <h1>üéÅ Combo ti·∫øt ki·ªám</h1>
                <p>Ti·∫øt ki·ªám h∆°n khi mua combo - Gi√° h·ªùi, ch·∫•t l∆∞·ª£ng!</p>
            </div>
        </div>

        <!-- SEARCH BAR -->
        <div class="menu-search-container animate-slide-up">
            <form method="get" asp-action="Index" class="menu-search-form">
                <div class="search-input-wrapper">
                    <span class="search-icon">üîç</span>
                    <input type="text" name="keyword" placeholder="T√¨m combo y√™u th√≠ch..." value="@keyword" />
                    @if (!string.IsNullOrEmpty(keyword))
                    {
                        <a href="/Combo" class="clear-search">‚úï</a>
                    }
                </div>
                <button type="submit" class="search-btn" style="background: #6c5ce7;">T√¨m ki·∫øm</button>
            </form>
        </div>

        <!-- SEARCH RESULT INFO -->
        @if (!string.IsNullOrEmpty(keyword))
        {
            <div class="d-flex justify-content-center mb-4">
                <div class="search-result-info">
                    T√¨m th·∫•y <strong>@Model.Count()</strong> k·∫øt qu·∫£ cho "<em>@keyword</em>"
                    <a href="/Combo" class="text-warning ms-2">X√≥a b·ªô l·ªçc</a>
                </div>
            </div>
        }

        <!-- COMBO GRID -->
        <div class="menu-grid">
            @if (!Model.Any())
            {
                <div style="grid-column: 1 / -1;">
                    <div class="menu-empty-state animate-fade-in">
                        <div class="empty-icon">üîç</div>
                        <h3>Kh√¥ng t√¨m th·∫•y combo n√†o</h3>
                        <p>H√£y th·ª≠ t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a kh√°c</p>
                        <a href="/Combo" class="btn btn-primary btn-lg rounded-pill px-4" style="background: #6c5ce7; border: none;">Xem t·∫•t c·∫£ combo</a>
                    </div>
                </div>
            }
            else
            {
                var delay = 0.0;
                @foreach (var combo in Model)
                {
                    <div class="menu-card combo-card animate-scale-in" style="animation-delay: @(delay)s;" onclick="openComboModal(@combo.Id)">
                        <!-- Badge -->
                        <span class="combo-badge">üî• HOT</span>
                        
                        <!-- Image -->
                        <div class="card-image">
                            <img src="@combo.ImageUrl" alt="@combo.Name" onerror="this.src='/images/no-image.png'" loading="lazy" />
                            <div class="card-overlay">
                                <span class="view-detail">üëÅÔ∏è Xem chi ti·∫øt</span>
                            </div>
                        </div>
                        
                        <!-- Info -->
                        <div class="card-content">
                            <h3 class="card-title">@combo.Name</h3>
                            <p class="card-description">@(combo.Description?.Length > 60 ? combo.Description.Substring(0, 60) + "..." : combo.Description)</p>
                            
                            <div class="card-footer">
                                <div class="card-price">
                                    <span class="price-value">@combo.Price.ToString("N0")</span>
                                    <span class="price-unit">‚Ç´</span>
                                </div>
                                <button class="card-add-btn" onclick="event.stopPropagation(); addComboToCart(@combo.Id)">
                                    <span>üõí</span> Th√™m
                                </button>
                            </div>
                        </div>
                    </div>
                    delay += 0.05;
                    if (delay > 0.5) delay = 0;
                }
            }
        </div>
    </div>
</div>

<!-- POPUP MODAL -->
<div id="comboModal" class="modal-overlay" style="display:none;">
    <div class="modal-content">
        <span class="close-btn" onclick="closeComboModal()">√ó</span>
        <div id="comboModalBody"></div>
    </div>
</div>