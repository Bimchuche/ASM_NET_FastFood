@model IEnumerable<ASM1_NET.Models.Category>
@{
    ViewData["Title"] = "Quáº£n lÃ½ danh má»¥c";
    var activeCount = Model.Count(c => c.IsActive);
    var inactiveCount = Model.Count(c => !c.IsActive);
}

<!-- ALERTS -->
@if (TempData["Success"] != null)
{
    <div class="admin-alert success">âœ… @TempData["Success"]</div>
}
@if (TempData["Error"] != null)
{
    <div class="admin-alert danger">âš ï¸ @TempData["Error"]</div>
}

<!-- Hidden form for bulk delete -->
<form id="bulkDeleteForm" asp-action="BulkDelete" method="post" style="display:none;">
    @Html.AntiForgeryToken()
    <div id="deleteIds"></div>
</form>

<!-- Page Header -->
<div class="admin-page-header">
    <div class="d-flex justify-content-between align-items-center flex-wrap gap-3">
        <div>
            <h2 class="admin-page-title">ğŸ“ Quáº£n lÃ½ danh má»¥c</h2>
            <p class="admin-page-subtitle">Quáº£n lÃ½ danh má»¥c sáº£n pháº©m</p>
        </div>
        <div class="d-flex gap-2">
            <button type="button" class="btn btn-admin btn-admin-delete" onclick="submitBulkDelete()">
                ğŸ—‘ï¸ XÃ³a Ä‘Ã£ chá»n (<span id="selectedCount">0</span>)
            </button>
            <a asp-action="Create" class="btn btn-admin btn-admin-add">
                â• ThÃªm danh má»¥c
            </a>
        </div>
    </div>
</div>

<!-- Stats Cards -->
<div class="admin-stats-row">
    <div class="admin-stat-card">
        <div class="stat-icon" style="background: linear-gradient(135deg, #10b981, #059669);">ğŸ“</div>
        <div class="stat-info">
            <span class="stat-value">@Model.Count()</span>
            <span class="stat-label">Tá»•ng danh má»¥c</span>
        </div>
    </div>
    <div class="admin-stat-card">
        <div class="stat-icon" style="background: linear-gradient(135deg, #3b82f6, #1d4ed8);">âœ…</div>
        <div class="stat-info">
            <span class="stat-value">@activeCount</span>
            <span class="stat-label">Äang hiá»ƒn thá»‹</span>
        </div>
    </div>
    <div class="admin-stat-card">
        <div class="stat-icon" style="background: linear-gradient(135deg, #f59e0b, #d97706);">ğŸš«</div>
        <div class="stat-info">
            <span class="stat-value">@inactiveCount</span>
            <span class="stat-label">Äang áº©n</span>
        </div>
    </div>
</div>

<!-- Search Filter -->
<div class="admin-filter-bar">
    <div class="search-box">
        <span class="search-icon">ğŸ”</span>
        <input type="text" id="searchInput" placeholder="TÃ¬m kiáº¿m danh má»¥c..." onkeyup="filterTable()" />
    </div>
</div>

<!-- Data Table -->
<div class="admin-table-card">
    <table class="admin-table" id="categoryTable">
        <thead>
            <tr>
                <th width="40"><input type="checkbox" id="selectAll" onclick="toggleAll(this)"></th>
                <th width="80">ID</th>
                <th>TÃªn danh má»¥c</th>
                <th>MÃ´ táº£</th>
                <th width="120">Tráº¡ng thÃ¡i</th>
                <th width="150">HÃ nh Ä‘á»™ng</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var cat in Model)
            {
                <tr>
                    <td><input type="checkbox" class="item-checkbox" data-id="@cat.Id" onclick="updateCount()"></td>
                    <td>
                        <span class="id-badge">#@cat.Id</span>
                    </td>
                    <td>
                        <strong>@cat.Name</strong>
                    </td>
                    <td>
                        <span class="text-muted">@(cat.Description?.Length > 50 ? cat.Description.Substring(0, 50) + "..." : cat.Description ?? "â€”")</span>
                    </td>
                    <td>
                        @if (cat.IsActive)
                        {
                            <span class="status-badge status-active">âœ… Hiá»ƒn thá»‹</span>
                        }
                        else
                        {
                            <span class="status-badge status-inactive">ğŸš« áº¨n</span>
                        }
                    </td>
                    <td>
                        <div class="action-buttons">
                            <a asp-action="Edit" asp-route-id="@cat.Id" class="btn-action btn-edit" title="Sá»­a">
                                âœï¸
                            </a>
                            <a asp-action="Delete" asp-route-id="@cat.Id" 
                               class="btn-action btn-delete" 
                               title="XÃ³a"
                               onclick="return confirm('Báº¡n cÃ³ cháº¯c muá»‘n xÃ³a danh má»¥c nÃ y?')">
                                ğŸ—‘ï¸
                            </a>
                        </div>
                    </td>
                </tr>
            }
        </tbody>
    </table>
    
    @if (!Model.Any())
    {
        <div class="empty-state">
            <div class="empty-icon">ğŸ“</div>
            <h4>ChÆ°a cÃ³ danh má»¥c nÃ o</h4>
            <p>HÃ£y thÃªm danh má»¥c Ä‘áº§u tiÃªn</p>
        </div>
    }
</div>

<script src="~/admin/js/admin-table.js"></script>
<script>
function filterTable() {
    window.filterTable('searchInput', 'categoryTable');
}
function submitBulkDelete() {
    window.submitBulkDelete('danh má»¥c');
}
</script>