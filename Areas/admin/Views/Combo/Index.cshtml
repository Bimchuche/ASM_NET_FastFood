@model IEnumerable<ASM1_NET.Models.Combo>

@{
    ViewData["Title"] = "Qu·∫£n l√Ω Combo";
}

<!-- ALERTS -->
@if (TempData["Success"] != null)
{
    <div class="admin-alert success">‚úÖ @TempData["Success"]</div>
}
@if (TempData["Error"] != null)
{
    <div class="admin-alert danger">‚ùå @TempData["Error"]</div>
}

<!-- HEADER -->
<div class="d-flex justify-content-between align-items-center mb-4">
    <div>
        <h2 class="mb-1">üéÅ Qu·∫£n l√Ω Combo</h2>
        <p class="text-muted mb-0">T·ªïng: <strong>@Model.Count()</strong> combo</p>
    </div>
    <a asp-action="Create" class="btn-admin primary">
        <span>‚ûï</span> Th√™m combo m·ªõi
    </a>
</div>

<!-- TABLE CARD -->
<div class="admin-table-card">
    <div class="table-header">
        <h3>üìã Danh s√°ch combo</h3>
        <div class="table-search">
            <input type="text" id="searchCombo" placeholder="T√¨m ki·∫øm..." onkeyup="filterTable()" />
        </div>
    </div>
    
    <table class="admin-table" id="comboTable">
        <thead>
            <tr>
                <th style="width: 80px;">·∫¢nh</th>
                <th>T√™n combo</th>
                <th>M√¥ t·∫£</th>
                <th>Gi√°</th>
                <th>Tr·∫°ng th√°i</th>
                <th style="width: 150px;">H√†nh ƒë·ªông</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var combo in Model)
            {
                <tr>
                    <td>
                        @if (!string.IsNullOrEmpty(combo.ImageUrl))
                        {
                            <img src="@combo.ImageUrl" alt="@combo.Name" />
                        }
                        else
                        {
                            <div class="stat-icon warning" style="width: 50px; height: 50px; font-size: 1.2rem;">üéÅ</div>
                        }
                    </td>
                    <td>
                        <strong>@combo.Name</strong>
                    </td>
                    <td>
                        <small class="text-muted">@(combo.Description?.Length > 50 ? combo.Description.Substring(0, 50) + "..." : combo.Description ?? "Ch∆∞a c√≥ m√¥ t·∫£")</small>
                    </td>
                    <td>
                        <strong class="text-success">@combo.Price.ToString("N0") ‚Ç´</strong>
                    </td>
                    <td>
                        @if (combo.IsActive)
                        {
                            <span class="badge-admin success">‚úì ƒêang b√°n</span>
                        }
                        else
                        {
                            <span class="badge-admin danger">‚úï Ng·ª´ng b√°n</span>
                        }
                    </td>
                    <td>
                        <div class="action-btns">
                            <a asp-action="Edit" asp-route-id="@combo.Id" class="action-btn edit" title="S·ª≠a">
                                ‚úèÔ∏è
                            </a>
                            <a asp-action="Delete" asp-route-id="@combo.Id" class="action-btn delete" title="X√≥a"
                               onclick="return confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a combo n√†y?')">
                                üóëÔ∏è
                            </a>
                        </div>
                    </td>
                </tr>
            }
        </tbody>
    </table>
</div>

@section Scripts {
<script>
function filterTable() {
    var input = document.getElementById("searchCombo");
    var filter = input.value.toLowerCase();
    var table = document.getElementById("comboTable");
    var rows = table.getElementsByTagName("tr");
    
    for (var i = 1; i < rows.length; i++) {
        var cells = rows[i].getElementsByTagName("td");
        var found = false;
        for (var j = 0; j < cells.length; j++) {
            if (cells[j].textContent.toLowerCase().indexOf(filter) > -1) {
                found = true;
                break;
            }
        }
        rows[i].style.display = found ? "" : "none";
    }
}
</script>
}